
(function($,window,document,undefined){function createKeyCodeMap(){var map={};for(var charCode=65;charCode<=90;charCode++){map[charCode]=String.fromCharCode(charCode);}
return map;}
$.fn.menu=function menu(options){options=options||{};return this.each(function onEach(){var $widget=$(this);var $button=$widget.find('button');var $rootMenu=$widget.find('> [role=menu], > *:last-child > [role=menu]').first();var $groups=$rootMenu.find('> div[role=presentation]');var $allMenuItems=$rootMenu.find('> [role^=menuitem], > div > [role^=menuitem], > a');var $links=$rootMenu.find('a');var $buttons=$rootMenu.find('[role=menuitem]');var $checkboxes=$rootMenu.find('[role=menuitemcheckbox]');var $radios=$rootMenu.find('[role=menuitemradio]');var $firstMenuItem=$allMenuItems.first();var $subMenus=$rootMenu.find('[role=menuitem][aria-haspopup=true]');var keyCodeMap=createKeyCodeMap();var isSupportShortcutKey=!options.disableShortcutKey;var shortcutKeyMap={};if(isSupportShortcutKey){$allMenuItems.each(function(idx){var firstChar=$(this).text()[0];if(!shortcutKeyMap[firstChar]){shortcutKeyMap[firstChar]=idx;}});}
$widget.nextId('popupmenu');$widget.buttonFlyout({focusManagement:true});$rootMenu.commonKeyDown();$rootMenu.rovingTabindex('[role^=menuitem]',{axis:'y'});$rootMenu.prop('id',$widget.prop('id')+'-menu');$button.attr('aria-haspopup','true').prop('id',$widget.prop('id')+'-button');$subMenus.attr('aria-expanded','false');$rootMenu.on('click spaceKeyDown enterKeyDown','[role^=menuitem]',function(e){if(e.type==='enterKeyDown'){e.preventDefault();}
var $menuitem=$(this);var role=$menuitem.attr('role');switch(role){case"menuitemradio":$radios.attr('aria-checked','false');$menuitem.attr('aria-checked','true');break;case"menuitemcheckbox":$menuitem.attr('aria-checked',$menuitem.attr('aria-checked')==='true'?'false':'true');break;default:break;}
$menuitem.trigger('menuSelect');});$widget.on('buttonFlyoutOpen buttonFlyoutClose',function onShowOrHide(){$allMenuItems.attr('tabindex','-1');});if(isSupportShortcutKey){$allMenuItems.on('keydown',function(e){var char=keyCodeMap[e.keyCode];var itemIndex=shortcutKeyMap[char];if(itemIndex){$allMenuItems.get(itemIndex).focus();}});}
$widget.on('menuSelect',function onMenuSelect(e){$button.focus();});$widget.preventScrollKeys('[role^=menuitem]');$widget.addClass('menu--js');});};}(jQuery));